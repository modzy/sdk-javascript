:doctype: article
:icons: font
:source-highlighter: highlightjs
:docname: Javascript SDK





++++

<h1>Javascript SDK</h1>

<div align="center">
<br>
<br>
<img  src="https://www.modzy.com/wp-content/uploads/2019/10/modzy-logo-tm.svg" alt="Modzy" width="350" height="auto">
<br>
<br>
<br>
<br>
<p><b>Modzy's Javascript SDK queries models, submits inference jobs, and returns results directly to your editor.</b></p>
<br>
<img alt="GitHub contributors" src="https://img.shields.io/github/contributors/modzy/sdk-javascript">
<img alt="GitHub last commit" src="https://img.shields.io/github/last-commit/modzy/sdk-javascript">
<img alt="GitHub Release Date" src="https://img.shields.io/github/release-date/modzy/sdk-javascript">
</div>
<br>
<br>
<div align="center">
<a href=https://models.modzy.com/docs/how-to-guides/job-lifecycle style="text-decoration:none">The job lifecycle</a> |
<a href=https://models.modzy.com/docs/how-to-guides/api-keys style="text-decoration:none">API keys</a> |
<a href=/samples style="text-decoration:none">Samples</a> |
<a href=https://models.modzy.com/docs/home/home style="text-decoration:none">Documentation</a>
<br>
<br>
<br>
<br>
<br>
</div>
<br>
++++



== Installation

++++
<br>
<div align="center">
  <a href="https://asciinema.org/a/B1IkRkW4LjW7sufkjoMWoETH6"><img src="install.gif" style="max-width:100%"/></a>
</div>
<br>
++++

Clone the repository:

- `$ git clone https://github.com/modzy/sdk-javascript.git`

Use https://yarnpkg.com/[yarn] to package and install the SDK:

Globally:

- `$ yarn global add ./sdk-javascript`

In an existing project (directly from github):

- `$ yarn add modzy/sdk-javascript`


Or you can use https://nodejs.org/[npm]:

Globally

- `$ npm install -g ./sdk-javascript`

In an existing project (directly from github):

- `$ npm install modzy/sdk-javascript`

== Initialize

Once you have a `model` and `version` identified, get authenticated with your API key.

API keys are security credentials required to perform API requests to Modzy. Our API keys are composed of an ID that is split by a dot into two parts: the prefix and the body. +
The *prefix* is the API keys' visible part. It’s only used to identify the key and by itself, it’s unable to perform API requests.

link:https://models.modzy.com/docs/users-keys/api-keys/retrieve-users-api-keys[List your API keys]:

[source, js]
----
const keys = await modzyClient.getAccountingClient().getAPIKeys('your@email.com');
keys.forEach(
    key => {
      console.log(JSON.stringify(key));
    }
);
----

The *body* is the prefix’s complement and it’s required to perform API requests. Since it’s not stored on Modzy’s servers, it cannot be recovered. Make sure to save it securely. If lost, you can link:https://models.modzy.com/docs/users-keys/api-keys/replace-API-key[replace the API key's body].

link:https://models.modzy.com/docs/users-keys/api-keys/retrieve-full-API-key[Retrieve the API key's body]:

[source, js]
----

const hash = await modzyClient.getAccountingClient().getKeyBody('yourKey');
console.log("The hash is: "+hash);
----

Get authenticated with your API key:

[source, js]
----
const modzy = require('modzy-sdk');
const modzyClient = new modzy.ModzyClient("http://url.to.modzy/api", "prefix.body");
----

== Basic usage

++++
<br>
<div align="center">
<img src="js.gif" alt="basic usage" style="max-width:100%">
</div>
<br>
++++



=== Browse models

Modzy’s Marketplace includes pre-trained and re-trainable AI models from industry-leading machine learning companies, accelerating the process from data to value.

The Model service drives the Marketplace and can be integrated with other applications, scripts, and systems. It provides routes to list, search, and filter model and model-version details.

link:https://models.modzy.com/docs/marketplace/models/retrieve-models[List models]

[source, js]
----
const models = await modzyClient.getAllModels();
models.forEach(
    model => {
      console.log(JSON.stringify(model));
    }
);
----

Tags help categorize and filter models. They make model browsing easier.

link:https://models.modzy.com/docs/marketplace/tags/retrieve-tags[List tags]:

[source, js]
----
const tags = await modzyClient.getAllTags();
tags.forEach(
    tag => {
      console.log(JSON.stringify(tag));
    }
);
----

link:https://models.modzy.com/docs/marketplace/tags/retrieve-models-by-tags[List models by tag]:

[source, js]
----
const tagsModels = await modzyClient.getTagsAndModels("language_and_text");
tagsModels.models.forEach(
    model => {
        console.log(JSON.stringify(model));
    }
);
----

=== Get a model's details

Models accept specific *input file link:https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types[MIME] types*. Some models may require multiple input file types to run data accordingly. In this sample, we use a model that requires `text/plain`.

Models require inputs to have a specific *input name* declared in the job request. This name can be found in the model’s details. In this sample, we use a model that requires `input.txt`.

Additionally, users can set their own input names. When multiple input items are processed in a job, these names are helpful to identify and get each input’s results. In this sample, we use a model that requires `input-1` and `input-2`.

link:https://models.modzy.com/docs/marketplace/models/retrieve-model-details[Get a model's details]:

[source, js]
----
const saModel = await modzyClient.getModel("ed542963de");
console.log(JSON.stringify(saModel));
----

Model specific sample requests are available in the version details and in the Model Details page.

link:https://models.modzy.com/docs/marketplace/versions/retrieve-version-details[Get version details]:

[source, js]
----
let modelVersion = await modzyClient.getModelVersion("ed542963de", "0.0.27");
console.log("inputs:");
for(key in modelVersion.inputs){
    let input = modelVersion.inputs[key];
    console.log(`  key ${input.name}, type ${input.acceptedMediaTypes}, description: ${input.description}`);
}
console.log("outputs:");
for(key in modelVersion.outputs){
    let output = modelVersion.outputs[key];
    console.log(`  key ${output.name}, type ${output.mediaType}, description: ${output.description}`);
}
----

=== Submit a job and get results

A *job* is the process that sends data to a model, sets the model to run the data, and returns results.

Modzy supports several *input types* such as `text`, `embedded` for Base64 strings, `aws-s3` and `aws-s3-folder` for inputs hosted in buckets, and `jdbc` for inputs stored in databases. In this sample, we use `text`.

link:https://github.com/modzy/sdk-javascript/blob/readmeUpdates/samples.adoc[Here] are samples to submit jobs with `embedded`, `aws-s3`, `aws-s3-folder`, and `jdbc` input types.

link:https://models.modzy.com/docs/jobs/jobs/submit-job-text[Submit a job with the model, version, and input items]:

[source, js]
----
let job = await modzyClient.submitJobText(
                "ed542963de",
                "0.0.27",
                {
                    'input-1':{'input.txt':'Modzy is great'},
                    'input-2':{'input.txt':'Modzy is great'},
                }
            );
----

link:https://models.modzy.com/docs/jobs/jobs/retrieve-job-details[Hold until the inference is complete and results become available]:

[source, js]
----
job = await modzyClient.blockUntilComplete(job);
----

link:https://models.modzy.com/docs/jobs/results/retrieve-results[Get the results]:

Results are available per input item and can be identified with the name provided for each input item upon job request. You can also add an input name to the route and limit the results to any given input item.

Jobs requested for multiple input items may have partial results available prior to job completion.

[source, js]
----
let results = await modzyClient.getResult(job.jobIdentifier);
----



== Fetch errors

Errors may arise for different reasons. Fetch errors to know what is their cause and how to fix them.

[cols="1,1"]
|===
|`ApiError` | Wrapper for different errors, check code, message, url attributes.
|===

Submitting jobs:

[source, js]
----
try{
    let job = await modzyClient.submitJobText("ed542963de","0.0.27",{'input-1':{'input.txt':'Modzy is great'},});
}
catch(error){
    console.log("the job submission fails with code "+error.code+" and message "+error.message);
}
----

== Features

Modzy supports link:https://models.modzy.com/docs/features/batch-processing[batch processing], link:https://models.modzy.com/docs/features/explainability[explainability], and link:https://models.modzy.com/docs/features/model-drift[model drift detection].

== APIs

Here is a list of Modzy APIs. To see all the APIs, check our link:https://models.modzy.com/docs/home/home[Documentation].

:doc-pages: https://models.modzy.com/docs/
[cols=3*, stripes=even]
|===
|Feature|Code|Api route

|[small]#Get all models#
|[small]#modzyClient.getAllModels()#
|[small]#link:{doc-pages}marketplace/models/retrieve-all-models-versions[/api/models/all/versions/all]#

|[small]#List some models#
|[small]#modzyClient.getModels()#
|[small]#link:{doc-pages}marketplace/models/retrieve-models[/api/models]#

|[small]#Get model details#
|[small]#modzyClient.getModel()#
|[small]#link:{doc-pages}marketplace/models/retrieve-model-details[/api/models/:modelId]#

|[small]#Search models by name#
|[small]#modzyClient.getModelByName()#
|[small]#link:{doc-pages}marketplace/models/search-model-details[/api/models/search]#

|[small]#Get related models#
|[small]#modzyClient.getRelatedModels()#
|[small]#link:{doc-pages}marketplace/models/retrieve-related-models[/api/models/:modelId/related-models]#

|[small]#List model versions#
|[small]#modzyClient.getModelVersions()#
|[small]#link:{doc-pages}marketplace/versions/retrieve-versions[/api/models/:modelId/versions]#

|[small]#Get version details#
|[small]#modzyClient.getModelVersion()#
|[small]#link:{doc-pages}marketplace/versions/retrieve-version-details[/api/models/:modelId/versions/:version]#

|[small]#List tags#
|[small]#modzyClient.getAllTags()#
|[small]#link:{doc-pages}marketplace/tags/retrieve-tags[/api/models/tags]#

|[small]#Get models by tags#
|[small]#modzyClient.getTagsAndModels()#
|[small]#link:{doc-pages}marketplace/tags/retrieve-models-by-tags[/api/models/tags/:tagId]#

|[small]#Create a Job (Text)#
|[small]#modzyClient.submitJobText()#
|[small]#link:{doc-pages}jobs/jobs/submit-job-text[/api/jobs]#

|[small]#Create a Job (Embedded)#
|[small]#modzyClient.submitJobEmbedded()#
|[small]#link:{doc-pages}jobs/jobs/submit-job-embedded[/api/jobs]#

|[small]#Create a Job (AWS S3)#
|[small]#modzyClient.submitJobAWSS3()#
|[small]#link:{doc-pages}jobs/jobs/submit-job-aws[/api/jobs]#

|[small]#Create a Job (JDBC)#
|[small]#modzyClient.submitJobJDBC()#
|[small]#link:{doc-pages}jobs/jobs/submit-job-jdbc[/api/jobs]#

|[small]#Cancel a job#
|[small]#modzyClient.cancelJob()#
|[small]#link:{doc-pages}jobs/jobs/cancel-pending-job[/api/jobs/:jobId]#

|[small]#Hold until inference is complete#
|[small]#modzyClient.blockUntilComplete()#
|[small]#link:{doc-pages}jobs/jobs/submit-job-text[/api/jobs]#

|[small]#Get job details#
|[small]#modzyClient.getJob()#
|[small]#link:{doc-pages}jobs/jobs/retrieve-job-details[/api/jobs/:jobId]#

|[small]#Get results#
|[small]#modzyClient.cancelJob()#
|[small]#link:{doc-pages}jobs/results/retrieve-results[/api/results/:jobId]#

|[small]#List the job history#
|[small]#modzyClient.getJobHistory()#
|[small]#link:{doc-pages}jobs/job-history/retrieve-job-history[/api/jobs/history]#


|===

== Samples

++++
<p>Check out our <a href=/samples style="text-decoration:none">samples</a> for details on specific use cases.
</p>
++++

To run samples:

Set the base url and api key in each sample file:

[source, js]
----
// TODO: set the base url of modzy api and you api key
const modzyClient = new modzy.ModzyClient("http://modzy.url", "modzy-apy.key");
----
++++
<p>Or follow the instructions <a href="/contributing.adoc#set-environment-variables-in-bash" style="text-decoration:none">here</a> to learn more.
</p>
++++

And then, you can:

[source, bash]
----
`$ node samples/job_with_text_input_sample.js`
----

//== Older versions


== Contributing

++++
<p>We are happy to receive contributions from all of our users. Check out our <a href="/contributing.adoc" style="text-decoration:none">contributing file</a> to learn more.
</p>
++++

==== Code of conduct

++++
<a href="/CODE_OF_CONDUCT.md" style="text-decoration:none"><img src="https://img.shields.io/badge/Contributor%20Covenant-v2.0%20adopted-ff69b4.svg" alt="Contributor Covenant" style="max-width:100%;"></a>
++++

//== Credits
